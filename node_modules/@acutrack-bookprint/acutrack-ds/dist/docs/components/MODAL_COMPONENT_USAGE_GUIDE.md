# Modal Component Usage Guide

## Overview

The Modal component is a fully-featured, accessible dialog system with comprehensive customization options. It supports multiple sizes, vertical alignment options, focus trapping, keyboard navigation, and compound component patterns for maximum flexibility.

### ‚ú® Latest Features (v1.0.81+)

- **üéØ Vertical Alignment Control**: Choose between `'center'` (default) and `'top'` alignment
- **üìê Flexible Sizing**: Custom width, min-width, max-width props for precise control
- **‚ôø Accessibility**: Full ARIA support, focus trapping, keyboard navigation (Escape to close)
- **üé® Design System Integration**: Uses design system colors with automatic dark mode support
- **üì± Responsive Design**: Proper viewport constraints and mobile-friendly sizing
- **üîß Compound Components**: `Modal.Header`, `Modal.Body`, `Modal.Footer` for flexible layouts

## Table of Contents

1. [Installation](#installation)
2. [Basic Usage](#basic-usage)
3. [Component API](#component-api)
4. [Size Options](#size-options)
5. [Vertical Alignment](#vertical-alignment)
6. [Custom Width](#custom-width)
7. [Compound Components](#compound-components)
8. [Accessibility Features](#accessibility-features)
9. [Advanced Examples](#advanced-examples)
10. [Best Practices](#best-practices)
11. [Troubleshooting](#troubleshooting)

## Installation

```bash
npm install @acutrack-bookprint/acutrack-ds
```

```tsx
import { Modal } from '@acutrack-bookprint/acutrack-ds';
import '@acutrack-bookprint/acutrack-ds/dist/style.css';
```

## Basic Usage

### Simple Modal

```tsx
import React, { useState } from 'react';
import { Modal, Button } from '@acutrack-bookprint/acutrack-ds';

function App() {
  const [isOpen, setIsOpen] = useState(false);

  return (
    <>
      <Button onClick={() => setIsOpen(true)}>
        Open Modal
      </Button>

      <Modal isOpen={isOpen} onClose={() => setIsOpen(false)}>
        <Modal.Header>Modal Title</Modal.Header>
        <Modal.Body>
          <p>This is the modal content. You can put any content here.</p>
        </Modal.Body>
        <Modal.Footer>
          <Button variant="ghost" onClick={() => setIsOpen(false)}>
            Cancel
          </Button>
          <Button onClick={() => setIsOpen(false)}>
            Confirm
          </Button>
        </Modal.Footer>
      </Modal>
    </>
  );
}
```

## Component API

### Modal (Root) Props

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `isOpen` | `boolean` | **required** | Controls modal visibility |
| `onClose` | `() => void` | **required** | Callback when modal should close |
| `size` | `'sm' \| 'md' \| 'lg' \| 'xl' \| '2xl'` | `'md'` | Predefined width sizes |
| `customWidth` | `string` | - | Custom width (e.g., `'600px'`, `'80vw'`). Overrides `size` |
| `minWidth` | `string` | - | Minimum width constraint |
| `maxWidth` | `string` | - | Maximum width constraint |
| `verticalAlign` | `'center' \| 'top'` | `'center'` | Vertical alignment in viewport |
| `className` | `string` | - | Additional CSS classes for modal container |
| `children` | `React.ReactNode` | **required** | Modal content |

### Modal.Header Props

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `children` | `React.ReactNode` | **required** | Header title text |
| `className` | `string` | - | Additional CSS classes |

### Modal.Body Props

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `children` | `React.ReactNode` | **required** | Body content |
| `className` | `string` | - | Additional CSS classes |

### Modal.Footer Props

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `children` | `React.ReactNode` | **required** | Footer content (usually buttons) |
| `className` | `string` | - | Additional CSS classes |

## Size Options

The Modal supports 5 predefined sizes:

```tsx
// Small modal (24rem / 384px)
<Modal isOpen={isOpen} onClose={onClose} size="sm">
  <Modal.Header>Small Modal</Modal.Header>
  <Modal.Body>Content...</Modal.Body>
</Modal>

// Medium modal (28rem / 448px) - Default
<Modal isOpen={isOpen} onClose={onClose} size="md">
  <Modal.Header>Medium Modal</Modal.Header>
  <Modal.Body>Content...</Modal.Body>
</Modal>

// Large modal (32rem / 512px)
<Modal isOpen={isOpen} onClose={onClose} size="lg">
  <Modal.Header>Large Modal</Modal.Header>
  <Modal.Body>Content...</Modal.Body>
</Modal>

// Extra Large modal (36rem / 576px)
<Modal isOpen={isOpen} onClose={onClose} size="xl">
  <Modal.Header>XL Modal</Modal.Header>
  <Modal.Body>Content...</Modal.Body>
</Modal>

// 2XL modal (42rem / 672px)
<Modal isOpen={isOpen} onClose={onClose} size="2xl">
  <Modal.Header>2XL Modal</Modal.Header>
  <Modal.Body>Content...</Modal.Body>
</Modal>
```

### Size Reference Table

| Size | Width (rem) | Width (px) |
|------|-------------|------------|
| `sm` | 24rem | 384px |
| `md` | 28rem | 448px |
| `lg` | 32rem | 512px |
| `xl` | 36rem | 576px |
| `2xl` | 42rem | 672px |

## Vertical Alignment

### Center Alignment (Default)

The modal is vertically centered in the viewport using CSS flexbox with `margin: auto`:

```tsx
<Modal 
  isOpen={isOpen} 
  onClose={onClose} 
  verticalAlign="center"  // This is the default
>
  <Modal.Header>Centered Modal</Modal.Header>
  <Modal.Body>
    This modal is centered both horizontally and vertically.
  </Modal.Body>
</Modal>
```

### Top Alignment

The modal appears near the top of the viewport with a `4rem` (64px) top margin:

```tsx
<Modal 
  isOpen={isOpen} 
  onClose={onClose} 
  verticalAlign="top"
>
  <Modal.Header>Top-Aligned Modal</Modal.Header>
  <Modal.Body>
    This modal appears at the top of the viewport.
  </Modal.Body>
</Modal>
```

### When to Use Each Alignment

| Use Case | Recommended Alignment |
|----------|----------------------|
| Confirmation dialogs | `center` |
| Alert messages | `center` |
| Form modals | `center` or `top` |
| Large content modals | `top` |
| Wizards/multi-step | `top` |
| Image/video previews | `center` |

## Custom Width

### Using customWidth

Override the predefined sizes with a custom width:

```tsx
// Custom pixel width
<Modal 
  isOpen={isOpen} 
  onClose={onClose} 
  customWidth="600px"
>
  <Modal.Header>Custom Width Modal</Modal.Header>
  <Modal.Body>Content...</Modal.Body>
</Modal>

// Viewport-relative width
<Modal 
  isOpen={isOpen} 
  onClose={onClose} 
  customWidth="80vw"
>
  <Modal.Header>Wide Modal</Modal.Header>
  <Modal.Body>Content...</Modal.Body>
</Modal>

// Rem-based width
<Modal 
  isOpen={isOpen} 
  onClose={onClose} 
  customWidth="50rem"
>
  <Modal.Header>50rem Modal</Modal.Header>
  <Modal.Body>Content...</Modal.Body>
</Modal>
```

### Using minWidth and maxWidth

Add constraints to modal sizing:

```tsx
<Modal 
  isOpen={isOpen} 
  onClose={onClose} 
  size="lg"
  minWidth="400px"
  maxWidth="800px"
>
  <Modal.Header>Constrained Modal</Modal.Header>
  <Modal.Body>
    This modal will be at least 400px and at most 800px wide.
  </Modal.Body>
</Modal>
```

## Compound Components

### Modal.Header

The header includes a title and close button. The close button is automatically rendered:

```tsx
<Modal.Header className="bg-blue-50">
  Custom Styled Header
</Modal.Header>
```

### Modal.Body

The body is scrollable when content exceeds the viewport height:

```tsx
<Modal.Body className="space-y-4">
  <p>First paragraph...</p>
  <p>Second paragraph...</p>
  {/* Content automatically scrolls if needed */}
</Modal.Body>
```

### Modal.Footer

The footer typically contains action buttons, aligned to the right:

```tsx
<Modal.Footer>
  <Button variant="ghost" onClick={onClose}>
    Cancel
  </Button>
  <Button variant="outline" onClick={handleSecondary}>
    Secondary Action
  </Button>
  <Button onClick={handlePrimary}>
    Primary Action
  </Button>
</Modal.Footer>
```

## Accessibility Features

### Focus Trapping

The Modal automatically traps focus within the dialog:

- When opened, focus moves to the first focusable element
- Tab/Shift+Tab cycles through focusable elements within the modal
- When closed, focus returns to the triggering element

### Keyboard Navigation

| Key | Action |
|-----|--------|
| `Escape` | Close the modal |
| `Tab` | Move to next focusable element |
| `Shift + Tab` | Move to previous focusable element |

### ARIA Attributes

The Modal includes proper ARIA attributes:

```html
<div 
  role="dialog" 
  aria-modal="true" 
  aria-labelledby="modal-title" 
  aria-describedby="modal-description"
>
  <!-- Modal content -->
</div>
```

### Screen Reader Support

- Modal title is announced when opened
- Modal description is available via `aria-describedby`
- Close button has proper `aria-label`

## Advanced Examples

### Confirmation Dialog

```tsx
function DeleteConfirmation({ isOpen, onClose, onConfirm, itemName }) {
  return (
    <Modal isOpen={isOpen} onClose={onClose} size="sm">
      <Modal.Header>Confirm Deletion</Modal.Header>
      <Modal.Body>
        <p>Are you sure you want to delete <strong>{itemName}</strong>?</p>
        <p className="text-sm text-text-secondary mt-2">
          This action cannot be undone.
        </p>
      </Modal.Body>
      <Modal.Footer>
        <Button variant="ghost" onClick={onClose}>
          Cancel
        </Button>
        <Button variant="danger" onClick={onConfirm}>
          Delete
        </Button>
      </Modal.Footer>
    </Modal>
  );
}
```

### Form Modal

```tsx
function EditUserModal({ isOpen, onClose, user }) {
  const [formData, setFormData] = useState(user);

  const handleSubmit = (e) => {
    e.preventDefault();
    // Submit logic...
    onClose();
  };

  return (
    <Modal isOpen={isOpen} onClose={onClose} size="lg">
      <form onSubmit={handleSubmit}>
        <Modal.Header>Edit User</Modal.Header>
        <Modal.Body>
          <div className="space-y-4">
            <Input
              label="Name"
              value={formData.name}
              onChange={(e) => setFormData({ ...formData, name: e.target.value })}
            />
            <Input
              label="Email"
              type="email"
              value={formData.email}
              onChange={(e) => setFormData({ ...formData, email: e.target.value })}
            />
          </div>
        </Modal.Body>
        <Modal.Footer>
          <Button variant="ghost" type="button" onClick={onClose}>
            Cancel
          </Button>
          <Button type="submit">
            Save Changes
          </Button>
        </Modal.Footer>
      </form>
    </Modal>
  );
}
```

### Long Content Modal

```tsx
function TermsModal({ isOpen, onClose, onAccept }) {
  return (
    <Modal 
      isOpen={isOpen} 
      onClose={onClose} 
      size="xl"
      verticalAlign="top"
    >
      <Modal.Header>Terms and Conditions</Modal.Header>
      <Modal.Body>
        {/* Long content - body automatically scrolls */}
        <div className="prose">
          <h3>1. Introduction</h3>
          <p>Lorem ipsum dolor sit amet...</p>
          
          <h3>2. User Agreement</h3>
          <p>By using this service, you agree to...</p>
          
          {/* More sections... */}
        </div>
      </Modal.Body>
      <Modal.Footer>
        <Button variant="ghost" onClick={onClose}>
          Decline
        </Button>
        <Button onClick={onAccept}>
          Accept Terms
        </Button>
      </Modal.Footer>
    </Modal>
  );
}
```

### Nested Modal (Not Recommended)

While technically possible, nested modals are generally discouraged for UX reasons. Consider using a single modal with multiple steps instead.

## Best Practices

### 1. Always Provide onClose

```tsx
// ‚úÖ Good
<Modal isOpen={isOpen} onClose={() => setIsOpen(false)}>

// ‚ùå Bad - no way to close
<Modal isOpen={isOpen}>
```

### 2. Use Appropriate Sizes

```tsx
// ‚úÖ Good - small modal for simple confirmations
<Modal size="sm">
  <Modal.Header>Confirm</Modal.Header>
  <Modal.Body>Are you sure?</Modal.Body>
</Modal>

// ‚úÖ Good - larger modal for forms
<Modal size="lg">
  <Modal.Header>Edit Profile</Modal.Header>
  <Modal.Body>{/* Form fields */}</Modal.Body>
</Modal>
```

### 3. Consistent Footer Button Order

```tsx
// ‚úÖ Good - Cancel on left, primary action on right
<Modal.Footer>
  <Button variant="ghost" onClick={onClose}>Cancel</Button>
  <Button onClick={onConfirm}>Confirm</Button>
</Modal.Footer>

// ‚úÖ Also acceptable - destructive action warning
<Modal.Footer>
  <Button variant="ghost" onClick={onClose}>Cancel</Button>
  <Button variant="danger" onClick={onDelete}>Delete</Button>
</Modal.Footer>
```

### 4. Handle Loading States

```tsx
<Modal.Footer>
  <Button variant="ghost" onClick={onClose} disabled={isLoading}>
    Cancel
  </Button>
  <Button onClick={onSubmit} loading={isLoading}>
    {isLoading ? 'Saving...' : 'Save'}
  </Button>
</Modal.Footer>
```

### 5. Close Modal on Successful Actions

```tsx
const handleSubmit = async () => {
  try {
    await saveData();
    onClose();  // ‚úÖ Close on success
    showToast('Success!');
  } catch (error) {
    showToast('Error occurred', 'error');
    // Don't close - let user retry
  }
};
```

## Troubleshooting

### Modal Not Centering

**Problem**: Modal appears off-center or at wrong position

**Solution**: Ensure you're using the correct `verticalAlign` prop:

```tsx
// ‚úÖ For centered modals
<Modal verticalAlign="center">

// ‚úÖ For top-aligned modals
<Modal verticalAlign="top">
```

### Content Overflowing

**Problem**: Modal content extends beyond viewport

**Solution**: The `Modal.Body` automatically handles scroll:

```tsx
<Modal.Body>
  {/* Long content automatically scrolls */}
</Modal.Body>
```

### Modal Not Closing

**Problem**: Clicking backdrop or pressing Escape doesn't close modal

**Solution**: Ensure `onClose` prop is correctly passed:

```tsx
<Modal 
  isOpen={isOpen} 
  onClose={() => setIsOpen(false)}  // ‚úÖ Must be a function
>
```

### Focus Issues

**Problem**: Focus not returning to trigger element

**Solution**: This is handled automatically. Ensure the trigger element is focusable:

```tsx
<Button onClick={() => setIsOpen(true)}>  {/* ‚úÖ Button is focusable */}
  Open Modal
</Button>
```

### Z-Index Conflicts

**Problem**: Modal appears behind other elements

**Solution**: The modal uses `z-50` by default. If you have elements with higher z-index, you may need to adjust your CSS:

```css
/* Your higher z-index elements might need adjustment */
.my-floating-element {
  z-index: 40;  /* Lower than modal's z-50 */
}
```

## Migration Guide

### From Custom Modal Implementations

If you're migrating from a custom modal implementation:

```tsx
// ‚ùå Old custom implementation
<div className={`modal ${isOpen ? 'open' : ''}`}>
  <div className="modal-backdrop" onClick={onClose} />
  <div className="modal-content">
    <h2>Title</h2>
    <p>Content</p>
    <button onClick={onClose}>Close</button>
  </div>
</div>

// ‚úÖ New Acutrack DS Modal
<Modal isOpen={isOpen} onClose={onClose}>
  <Modal.Header>Title</Modal.Header>
  <Modal.Body>
    <p>Content</p>
  </Modal.Body>
  <Modal.Footer>
    <Button onClick={onClose}>Close</Button>
  </Modal.Footer>
</Modal>
```

## Support

For additional support and examples, visit our [Component Test Hub](http://localhost:5175/component-test-hub.html) or check the [Modal Test Page](http://localhost:5175/modal-test.html) for interactive examples.

