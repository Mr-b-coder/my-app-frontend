# OTP Input Component Documentation

## Overview

The OTP (One-Time Password) Input component is a specialized input field designed for entering verification codes, typically used in authentication flows such as email verification, password reset, and two-factor authentication.

## Features

- **Auto-navigation**: Automatically moves to the next input field when a digit is entered
- **Paste support**: Allows pasting multi-digit codes
- **Keyboard navigation**: Arrow keys, backspace, and other keyboard shortcuts
- **Resend functionality**: Built-in resend button with cooldown timer
- **Expiry timer**: Shows remaining time for OTP validity
- **Custom validation**: Real-time validation with custom functions
- **Success/Error states**: Visual feedback for different states
- **Animations**: Smooth transitions and success/error animations
- **Multiple sizes**: Small, medium, and large variants
- **Multiple styles**: Primary, outline, ghost, and filled variants

## Basic Usage

```tsx
import { OTPInput } from '@acutrack/design-system';

function MyComponent() {
  const [otp, setOtp] = useState('');

  return (
    <OTPInput
      id="otp-input"
      label="Enter OTP"
      value={otp}
      onChange={setOtp}
      length={6}
      placeholder="0"
    />
  );
}
```

## Props

### Core Props

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `id` | `string` | - | Unique identifier for the OTP input field |
| `label` | `string` | - | Label text displayed above the input |
| `value` | `string` | - | Current OTP value |
| `onChange` | `(value: string) => void` | - | Callback when OTP value changes |
| `length` | `number` | `6` | Number of OTP digits |

### Appearance Props

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `size` | `'sm' \| 'md' \| 'lg'` | `'md'` | Size of the input fields |
| `variant` | `'primary' \| 'secondary' \| 'outline' \| 'ghost' \| 'filled'` | `'primary'` | Visual variant |
| `color` | `'primary' \| 'success' \| 'warning' \| 'danger' \| 'info'` | `'primary'` | Color theme |
| `radius` | `'none' \| 'sm' \| 'md' \| 'lg' \| 'xl' \| 'full'` | `'md'` | Border radius |

### Behavior Props

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `autoFocus` | `boolean` | `true` | Auto-focus the first input |
| `allowPaste` | `boolean` | `true` | Allow pasting OTP codes |
| `maskInput` | `boolean` | `false` | Mask the input (password style) |
| `isDisabled` | `boolean` | `false` | Disable the input |
| `isReadOnly` | `boolean` | `false` | Make input read-only |

### Resend & Timer Props

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `showResendButton` | `boolean` | `false` | Show resend button |
| `resendButtonText` | `string` | `'Resend OTP'` | Text for resend button |
| `onResend` | `() => void` | - | Callback when resend is clicked |
| `resendCooldown` | `number` | `30` | Resend cooldown in seconds |
| `showTimer` | `boolean` | `false` | Show expiry timer |
| `timerDuration` | `number` | `300` | Timer duration in seconds |
| `onTimerExpire` | `() => void` | - | Callback when timer expires |

### Validation Props

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `error` | `string` | - | Error message to display |
| `isSuccess` | `boolean` | `false` | Show success state |
| `isWarning` | `boolean` | `false` | Show warning state |
| `validateOTP` | `(otp: string) => { isValid: boolean; message?: string }` | - | Custom validation function |
| `showValidation` | `boolean` | `true` | Show validation feedback |

### Animation Props

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `showSuccessAnimation` | `boolean` | `true` | Show success animation |
| `showErrorAnimation` | `boolean` | `true` | Show error animation |

### Helper Props

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `helperText` | `string` | - | Helper text below input |
| `showHelperText` | `boolean` | `true` | Show helper text |
| `showClearButton` | `boolean` | `false` | Show clear button |
| `onClear` | `() => void` | - | Callback when clear is clicked |

## Examples

### Basic OTP Input

```tsx
<OTPInput
  id="basic-otp"
  label="Enter verification code"
  value={otp}
  onChange={setOtp}
  length={6}
  placeholder="0"
  helperText="Enter the 6-digit code sent to your email"
/>
```

### OTP with Resend Button

```tsx
<OTPInput
  id="otp-with-resend"
  label="Enter OTP"
  value={otp}
  onChange={setOtp}
  showResendButton={true}
  resendButtonText="Resend Code"
  onResend={handleResend}
  resendCooldown={30}
/>
```

### OTP with Timer

```tsx
<OTPInput
  id="otp-with-timer"
  label="Enter verification code"
  value={otp}
  onChange={setOtp}
  showTimer={true}
  timerDuration={300}
  onTimerExpire={handleTimerExpire}
/>
```

### OTP with Custom Validation

```tsx
const validateOTP = (otp: string) => {
  if (otp.length < 6) {
    return { isValid: false, message: 'Please enter all 6 digits' };
  }
  if (otp === '123456') {
    return { isValid: true, message: 'OTP verified!' };
  }
  return { isValid: false, message: 'Invalid OTP' };
};

<OTPInput
  id="otp-with-validation"
  label="Enter OTP"
  value={otp}
  onChange={setOtp}
  validateOTP={validateOTP}
  showValidation={true}
/>
```

### Different Sizes

```tsx
// Small size
<OTPInput
  id="small-otp"
  label="Small OTP"
  value={otp}
  onChange={setOtp}
  size="sm"
  length={4}
/>

// Medium size (default)
<OTPInput
  id="medium-otp"
  label="Medium OTP"
  value={otp}
  onChange={setOtp}
  size="md"
  length={6}
/>

// Large size
<OTPInput
  id="large-otp"
  label="Large OTP"
  value={otp}
  onChange={setOtp}
  size="lg"
  length={6}
/>
```

### Different Variants

```tsx
// Primary variant (default)
<OTPInput
  id="primary-otp"
  label="Primary OTP"
  value={otp}
  onChange={setOtp}
  variant="primary"
/>

// Outline variant
<OTPInput
  id="outline-otp"
  label="Outline OTP"
  value={otp}
  onChange={setOtp}
  variant="outline"
/>

// Ghost variant
<OTPInput
  id="ghost-otp"
  label="Ghost OTP"
  value={otp}
  onChange={setOtp}
  variant="ghost"
/>

// Filled variant
<OTPInput
  id="filled-otp"
  label="Filled OTP"
  value={otp}
  onChange={setOtp}
  variant="filled"
/>
```

## Use Cases

### Email Verification

```tsx
function EmailVerification() {
  const [otp, setOtp] = useState('');
  const [isVerifying, setIsVerifying] = useState(false);

  const handleVerify = async () => {
    setIsVerifying(true);
    try {
      await verifyEmail(otp);
      // Handle success
    } catch (error) {
      // Handle error
    } finally {
      setIsVerifying(false);
    }
  };

  return (
    <div>
      <OTPInput
        id="email-verification"
        label="Enter email verification code"
        value={otp}
        onChange={setOtp}
        length={6}
        isLoading={isVerifying}
        showResendButton={true}
        onResend={resendVerificationCode}
        helperText="Check your email for the verification code"
      />
      <Button onClick={handleVerify} disabled={otp.length !== 6}>
        Verify Email
      </Button>
    </div>
  );
}
```

### Password Reset

```tsx
function PasswordReset() {
  const [otp, setOtp] = useState('');
  const [timer, setTimer] = useState(600); // 10 minutes

  return (
    <OTPInput
      id="password-reset"
      label="Enter reset code"
      value={otp}
      onChange={setOtp}
      length={6}
      showTimer={true}
      timerDuration={timer}
      onTimerExpire={() => setTimer(0)}
      showResendButton={true}
      onResend={resendResetCode}
      helperText="Enter the code sent to your registered email"
    />
  );
}
```

### Two-Factor Authentication

```tsx
function TwoFactorAuth() {
  const [otp, setOtp] = useState('');
  const [isValidating, setIsValidating] = useState(false);

  const validateOTP = async (code: string) => {
    setIsValidating(true);
    try {
      const isValid = await validateTwoFactorCode(code);
      return { isValid, message: isValid ? 'Code verified!' : 'Invalid code' };
    } catch (error) {
      return { isValid: false, message: 'Verification failed' };
    } finally {
      setIsValidating(false);
    }
  };

  return (
    <OTPInput
      id="two-factor"
      label="Enter 2FA code"
      value={otp}
      onChange={setOtp}
      length={6}
      validateOTP={validateOTP}
      showValidation={true}
      isLoading={isValidating}
      helperText="Enter the code from your authenticator app"
    />
  );
}
```

## Keyboard Navigation

- **Arrow Left/Right**: Navigate between input fields
- **Backspace**: Clear current input and move to previous field
- **Numbers**: Enter digits (0-9)
- **Paste**: Paste multi-digit codes (Ctrl+V/Cmd+V)
- **Tab**: Move focus to next element
- **Enter**: Submit form (if in form context)

## Accessibility

- **ARIA labels**: Proper labeling for screen readers
- **Keyboard navigation**: Full keyboard support
- **Focus management**: Clear focus indicators
- **Error announcements**: Screen reader announcements for errors
- **High contrast**: Support for high contrast modes

## Best Practices

1. **Always provide clear labels** and helper text
2. **Use appropriate length** for your use case (typically 4-8 digits)
3. **Implement resend functionality** with cooldown to prevent spam
4. **Show timer** for time-sensitive OTPs
5. **Provide clear error messages** for invalid codes
6. **Use success states** to confirm valid codes
7. **Test with screen readers** for accessibility
8. **Handle edge cases** like expired codes and network errors

## Troubleshooting

### Common Issues

1. **OTP not advancing to next field**
   - Ensure `onChange` is properly implemented
   - Check that `length` prop is set correctly

2. **Paste not working**
   - Verify `allowPaste` is set to `true`
   - Check that pasted content contains only digits

3. **Timer not showing**
   - Ensure `showTimer` is set to `true`
   - Check that `timerDuration` is set correctly

4. **Resend button not working**
   - Verify `showResendButton` is set to `true`
   - Implement `onResend` callback function

### Performance Tips

1. **Debounce validation** for real-time validation
2. **Use React.memo** for parent components if needed
3. **Limit animation frequency** for better performance
4. **Clean up timers** in useEffect cleanup functions

## Migration Guide

### From Custom OTP Implementation

```tsx
// Before: Custom implementation
<div className="otp-container">
  {Array.from({ length: 6 }, (_, i) => (
    <input
      key={i}
      type="text"
      maxLength={1}
      onChange={(e) => handleChange(i, e.target.value)}
    />
  ))}
</div>

// After: Using OTPInput component
<OTPInput
  id="otp"
  label="Enter OTP"
  value={otp}
  onChange={setOtp}
  length={6}
/>
```

## Changelog

### Version 1.0.0
- Initial release of OTPInput component
- Basic functionality with auto-navigation
- Paste support and keyboard navigation
- Resend button with cooldown
- Timer functionality
- Custom validation support
- Multiple sizes and variants
- Success/error states and animations
- Full accessibility support
