# FileUploader Component Guide

## Overview

The FileUploader component is a modern, industry-standard file upload interface that provides drag-and-drop functionality, file validation, previews, and comprehensive accessibility support. It follows the same clean API pattern as other components in the Acutrack Design System.

## Features

### ✅ **Core Features**
- **Drag & Drop**: Intuitive drag-and-drop file selection
- **File Validation**: Size limits, type restrictions, and custom validation
- **File Previews**: Image thumbnails and file type icons
- **Multiple Selection**: Support for single or multiple file uploads
- **Progress Indication**: Visual feedback for upload progress
- **Error Handling**: Clear error messages and validation feedback
- **Accessibility**: Full keyboard navigation and screen reader support

### ✅ **Industry Standards**
- **Clean API**: Only essential props, no over-engineering
- **Consistent Styling**: Matches design system patterns
- **Responsive Design**: Works on all screen sizes
- **TypeScript Support**: Full type safety and IntelliSense
- **Performance**: Optimized with React hooks and callbacks

## API Reference

### Props

```tsx
interface FileUploaderProps {
  // Core functionality
  files: File[];
  onFilesChange: (files: File[]) => void;
  
  // Basic configuration
  multiple?: boolean;
  accept?: string; // MIME types or extensions
  maxSize?: number; // bytes
  maxFiles?: number;
  
  // UI customization
  variant?: 'default' | 'outlined' | 'filled' | 'minimal';
  size?: 'xs' | 'sm' | 'md' | 'lg' | 'xl';
  color?: 'primary' | 'success' | 'warning' | 'danger' | 'info';
  disabled?: boolean;
  
  // Content
  label?: string;
  description?: string;
  placeholder?: string;
  helpText?: string;
  error?: string;
  required?: boolean;
  
  // Features
  showPreview?: boolean;
  showProgress?: boolean;
  showFileList?: boolean;
  showDragInstructions?: boolean;
  
  // Validation
  onValidation?: (errors: FileValidationError[]) => void;
  onUploadError?: (error: string) => void;
  
  // Styling
  className?: string;
  style?: React.CSSProperties;
}
```

### Types

```tsx
type FileUploaderSize = 'xs' | 'sm' | 'md' | 'lg' | 'xl';
type FileUploaderVariant = 'default' | 'outlined' | 'filled' | 'minimal';
type FileUploaderColor = 'primary' | 'success' | 'warning' | 'danger' | 'info';

type FileValidationError = {
  file: File;
  errors: string[];
};
```

## Usage Examples

### Basic Usage

```tsx
import { FileUploader } from '@acutrack-bookprint/acutrack-ds';

function BasicUpload() {
  const [files, setFiles] = useState<File[]>([]);

  return (
    <FileUploader
      label="Upload Files"
      files={files}
      onFilesChange={setFiles}
      multiple={true}
    />
  );
}
```

### With Validation

```tsx
function ValidatedUpload() {
  const [files, setFiles] = useState<File[]>([]);
  const [errors, setErrors] = useState<string[]>([]);

  return (
    <FileUploader
      label="Upload Images"
      files={files}
      onFilesChange={setFiles}
      multiple={true}
      accept="image/*"
      maxSize={2 * 1024 * 1024} // 2MB
      maxFiles={5}
      showPreview={true}
      showFileList={true}
      description="Upload up to 5 images, max 2MB each"
      helpText="Supported formats: JPG, PNG, GIF, WebP"
      onValidation={(validationErrors) => {
        const allErrors = validationErrors.flatMap(error => error.errors);
        setErrors(allErrors);
      }}
    />
  );
}
```

### Document Upload

```tsx
function DocumentUpload() {
  const [files, setFiles] = useState<File[]>([]);

  return (
    <FileUploader
      label="Upload Documents"
      files={files}
      onFilesChange={setFiles}
      multiple={true}
      accept=".pdf,.doc,.docx,.txt,.rtf"
      maxSize={10 * 1024 * 1024} // 10MB
      variant="outlined"
      size="lg"
      description="Upload documents for review"
      helpText="Maximum file size: 10MB per document"
    />
  );
}
```

### Profile Picture Upload

```tsx
function ProfilePictureUpload() {
  const [file, setFile] = useState<File[]>([]);

  return (
    <FileUploader
      label="Profile Picture"
      files={file}
      onFilesChange={setFile}
      multiple={false}
      accept="image/jpeg,image/png"
      maxSize={500 * 1024} // 500KB
      showPreview={true}
      showFileList={false}
      variant="filled"
      color="primary"
      description="Upload your profile picture"
      helpText="Single file, maximum 500KB, JPEG or PNG only"
    />
  );
}
```

### With Error Handling

```tsx
function UploadWithErrors() {
  const [files, setFiles] = useState<File[]>([]);
  const [uploadError, setUploadError] = useState<string>('');

  const handleUpload = async () => {
    try {
      // Simulate upload
      await uploadFiles(files);
      setFiles([]);
      setUploadError('');
    } catch (error) {
      setUploadError('Upload failed. Please try again.');
    }
  };

  return (
    <div>
      <FileUploader
        label="Upload Files"
        files={files}
        onFilesChange={setFiles}
        multiple={true}
        error={uploadError}
        onUploadError={setUploadError}
      />
      {files.length > 0 && (
        <Button onClick={handleUpload}>
          Upload {files.length} file{files.length !== 1 ? 's' : ''}
        </Button>
      )}
    </div>
  );
}
```

## Variants

### Default Variant
```tsx
<FileUploader variant="default" files={files} onFilesChange={setFiles} />
```
- Clean white background with dashed border
- Subtle hover effects
- Best for general use

### Outlined Variant
```tsx
<FileUploader variant="outlined" files={files} onFilesChange={setFiles} />
```
- Transparent background with solid border
- More prominent border
- Good for forms and cards

### Filled Variant
```tsx
<FileUploader variant="filled" files={files} onFilesChange={setFiles} />
```
- Background color with dashed border
- More visual weight
- Good for emphasis

### Minimal Variant
```tsx
<FileUploader variant="minimal" files={files} onFilesChange={setFiles} />
```
- Minimal styling with thin border
- Subtle appearance
- Good for compact layouts

## Sizes

### Extra Small (xs)
```tsx
<FileUploader size="xs" files={files} onFilesChange={setFiles} />
```
- Compact height (64px)
- Small padding
- Good for inline forms

### Small (sm)
```tsx
<FileUploader size="sm" files={files} onFilesChange={setFiles} />
```
- Small height (80px)
- Moderate padding
- Good for compact layouts

### Medium (md) - Default
```tsx
<FileUploader size="md" files={files} onFilesChange={setFiles} />
```
- Standard height (96px)
- Balanced padding
- Good for most use cases

### Large (lg)
```tsx
<FileUploader size="lg" files={files} onFilesChange={setFiles} />
```
- Large height (128px)
- Generous padding
- Good for prominent uploads

### Extra Large (xl)
```tsx
<FileUploader size="xl" files={files} onFilesChange={setFiles} />
```
- Extra large height (160px)
- Maximum padding
- Good for hero sections

## File Validation

### Size Validation
```tsx
<FileUploader
  maxSize={5 * 1024 * 1024} // 5MB
  files={files}
  onFilesChange={setFiles}
/>
```

### Type Validation
```tsx
<FileUploader
  accept="image/*,.pdf,.doc,.docx"
  files={files}
  onFilesChange={setFiles}
/>
```

### Count Validation
```tsx
<FileUploader
  maxFiles={10}
  files={files}
  onFilesChange={setFiles}
/>
```

### Custom Validation
```tsx
<FileUploader
  files={files}
  onFilesChange={setFiles}
  onValidation={(errors) => {
    errors.forEach(error => {
      console.log(`${error.file.name}: ${error.errors.join(', ')}`);
    });
  }}
/>
```

## File Previews

### Image Previews
```tsx
<FileUploader
  accept="image/*"
  showPreview={true}
  files={files}
  onFilesChange={setFiles}
/>
```

### File Type Icons
The component automatically shows appropriate icons for different file types:
- **Images**: `image` icon
- **Videos**: `video_file` icon
- **Audio**: `audio_file` icon
- **PDFs**: `picture_as_pdf` icon
- **Documents**: `description` icon
- **Spreadsheets**: `table_chart` icon
- **Presentations**: `slideshow` icon
- **Archives**: `folder_zip` icon
- **Other**: `insert_drive_file` icon

## Accessibility

### Keyboard Navigation
- **Tab**: Focus the upload area
- **Enter/Space**: Open file dialog
- **Escape**: Cancel file selection

### Screen Reader Support
- Proper ARIA labels and descriptions
- File validation errors announced
- Upload progress announced
- File list with proper semantics

### ARIA Attributes
```tsx
<FileUploader
  label="Upload Files" // Creates proper label association
  description="Upload your documents" // Provides context
  error="File too large" // Announces errors
  files={files}
  onFilesChange={setFiles}
/>
```

## Styling

### Custom Classes
```tsx
<FileUploader
  className="my-custom-uploader"
  files={files}
  onFilesChange={setFiles}
/>
```

### Custom Styles
```tsx
<FileUploader
  style={{ 
    borderColor: '#custom-color',
    backgroundColor: '#f0f0f0' 
  }}
  files={files}
  onFilesChange={setFiles}
/>
```

### Color Themes
```tsx
<FileUploader color="success" files={files} onFilesChange={setFiles} />
<FileUploader color="warning" files={files} onFilesChange={setFiles} />
<FileUploader color="danger" files={files} onFilesChange={setFiles} />
<FileUploader color="info" files={files} onFilesChange={setFiles} />
```

## Best Practices

### 1. File Validation
Always validate files on both client and server:
```tsx
<FileUploader
  accept="image/*"
  maxSize={2 * 1024 * 1024}
  maxFiles={5}
  onValidation={(errors) => {
    // Handle validation errors
    if (errors.length > 0) {
      showError('Some files failed validation');
    }
  }}
/>
```

### 2. User Feedback
Provide clear feedback for all states:
```tsx
<FileUploader
  files={files}
  onFilesChange={setFiles}
  description="Upload your profile picture"
  helpText="Maximum 2MB, JPEG or PNG only"
  error={uploadError}
/>
```

### 3. Progressive Enhancement
Start with basic functionality and add features progressively:
```tsx
// Basic
<FileUploader files={files} onFilesChange={setFiles} />

// Enhanced
<FileUploader 
  files={files} 
  onFilesChange={setFiles}
  showPreview={true}
  showFileList={true}
/>
```

### 4. Error Handling
Handle errors gracefully:
```tsx
<FileUploader
  files={files}
  onFilesChange={setFiles}
  onUploadError={(error) => {
    setUploadError(error);
    // Log error for debugging
    console.error('Upload error:', error);
  }}
/>
```

## Troubleshooting

### Common Issues

1. **Files not uploading**
   - Check `onFilesChange` callback
   - Verify file validation rules
   - Check browser console for errors

2. **Validation not working**
   - Ensure `accept` prop is correctly formatted
   - Check `maxSize` is in bytes
   - Verify `maxFiles` is a positive number

3. **Previews not showing**
   - Ensure `showPreview={true}`
   - Check if files are image types
   - Verify browser supports `URL.createObjectURL`

4. **Accessibility issues**
   - Ensure proper `label` is provided
   - Check ARIA attributes are present
   - Test with keyboard navigation

### Debug Tips

```tsx
<FileUploader
  files={files}
  onFilesChange={(newFiles) => {
    console.log('Files changed:', newFiles);
    setFiles(newFiles);
  }}
  onValidation={(errors) => {
    console.log('Validation errors:', errors);
  }}
/>
```

## Migration from Old FileUploader

### Before (Over-engineered)
```tsx
<FileUploader
  label="Upload Files"
  id="file-upload"
  files={files}
  onFilesChange={setFiles}
  multiple={true}
  hasFilePreview={true}
  hasFileValidation={true}
  hasDragInstructions={true}
  hasFileSizeInfo={true}
  hasFileTypeInfo={true}
  hasFileList={true}
  hasFileCount={true}
  hasRemoveAllButton={true}
  // ... 200+ more props
/>
```

### After (Clean API)
```tsx
<FileUploader
  label="Upload Files"
  files={files}
  onFilesChange={setFiles}
  multiple={true}
  showPreview={true}
  showFileList={true}
  showDragInstructions={true}
  accept="image/*,.pdf"
  maxSize={5 * 1024 * 1024}
/>
```

## Performance Considerations

### File Size Limits
- Set appropriate `maxSize` to prevent memory issues
- Consider server-side validation for large files
- Use `maxFiles` to limit memory usage

### Preview Optimization
- Only enable `showPreview` when needed
- Consider lazy loading for many files
- Clean up object URLs to prevent memory leaks

### Validation Performance
- Client-side validation is fast but not secure
- Always validate on the server
- Use `onValidation` callback for custom logic

---

*This guide covers all aspects of using the FileUploader component. For more examples and advanced usage patterns, refer to the test pages and component documentation.*
