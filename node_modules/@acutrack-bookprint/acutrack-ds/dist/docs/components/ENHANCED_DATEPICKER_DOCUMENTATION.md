# Enhanced DatePicker Component Documentation

## Overview

The Enhanced DatePicker is a comprehensive, accessible, and type-safe React component built for the Acutrack Design System. It provides both single date selection and date range selection capabilities with full accessibility support, design system integration, and TypeScript types.

## Features

### ✅ Core Features
- **Single Date Picker**: Standard date picker for selecting a single date
- **Date Range Picker**: Date range picker for selecting start and end dates with visual range indication
- **Full Accessibility**: WCAG AA compliant with keyboard navigation and screen reader support
- **Design System Integration**: Uses design tokens for consistent styling
- **TypeScript Support**: Strict type definitions with no 'any' types
- **Dark Mode Support**: Full dark mode compatibility
- **Date Validation**: Min/max date constraints and custom date disabling
- **Custom Formatting**: Configurable date display format
- **First Day of Week**: Configurable week start (Sunday or Monday)

### ✅ Accessibility Features
- **Keyboard Navigation**: Full keyboard support with arrow keys, page up/down, home/end
- **ARIA Support**: Proper ARIA roles, properties, and labels
- **Focus Management**: Focus trapping in calendar and proper focus return
- **Screen Reader Support**: Comprehensive screen reader compatibility
- **High Contrast**: Proper contrast ratios for accessibility

### ✅ Design System Integration
- **Design Tokens**: Uses Tailwind CSS classes that reference design system tokens
- **Consistent Styling**: Matches design system color palette, spacing, and typography
- **Responsive Design**: Works across all device sizes
- **Theme Support**: Light and dark mode support

## Installation

The component is already included in the Acutrack Design System. To use it:

```typescript
import { EnhancedDatePicker, DateRange } from '@acutrack-bookprint/acutrack-ds';
```

## Dependencies

- `date-fns`: For date manipulation and formatting
- `react`: ^18.0.0 || ^19.0.0
- `react-dom`: ^18.0.0 || ^19.0.0

## API Reference

### Props

```typescript
interface DatePickerProps {
  /** The type of date picker to render */
  variant?: 'single' | 'range';
  /** The selected date or date range. Controlled component value. */
  value: Date | DateRange | null;
  /** Callback fired when the date value changes */
  onChange: (date: Date | DateRange | null) => void;
  /** The earliest date that can be selected */
  minDate?: Date;
  /** The latest date that can be selected */
  maxDate?: Date;
  /** A function to disable specific dates */
  isDateDisabled?: (date: Date) => boolean;
  /** Placeholder text for the input field */
  placeholder?: string;
  /** Disables the date picker */
  isDisabled?: boolean;
  /** Custom class name for the root element */
  className?: string;
  /** Whether to close the popover after selection */
  closeOnSelect?: boolean;
  /** Whether to show the today button */
  showTodayButton?: boolean;
  /** Whether to show the clear button */
  showClearButton?: boolean;
  /** Custom format for displaying dates */
  dateFormat?: string;
  /** First day of the week (0 = Sunday, 1 = Monday) */
  firstDayOfWeek?: 0 | 1;
}
```

### Types

```typescript
export type DatePickerVariant = 'single' | 'range';

export interface DateRange {
  start: Date | null;
  end: Date | null;
}
```

## Usage Examples

### Single Date Picker

```typescript
import React, { useState } from 'react';
import { EnhancedDatePicker } from '@acutrack-bookprint/acutrack-ds';

const MyComponent = () => {
  const [selectedDate, setSelectedDate] = useState<Date | null>(null);

  return (
    <EnhancedDatePicker
      variant="single"
      value={selectedDate}
      onChange={(date) => setSelectedDate(date as Date | null)}
      placeholder="Select a date"
      minDate={new Date()}
    />
  );
};
```

### Date Range Picker

```typescript
import React, { useState } from 'react';
import { EnhancedDatePicker, DateRange } from '@acutrack-bookprint/acutrack-ds';

const MyComponent = () => {
  const [dateRange, setDateRange] = useState<DateRange | null>(null);

  return (
    <EnhancedDatePicker
      variant="range"
      value={dateRange}
      onChange={(date) => setDateRange(date as DateRange | null)}
      placeholder="Select date range"
      isDateDisabled={(date) => date.getDay() === 0} // Disable Sundays
    />
  );
};
```

### With Date Constraints

```typescript
import React, { useState } from 'react';
import { EnhancedDatePicker } from '@acutrack-bookprint/acutrack-ds';
import { addMonths } from 'date-fns';

const MyComponent = () => {
  const [selectedDate, setSelectedDate] = useState<Date | null>(null);
  const today = new Date();
  const maxDate = addMonths(today, 3);

  return (
    <EnhancedDatePicker
      variant="single"
      value={selectedDate}
      onChange={(date) => setSelectedDate(date as Date | null)}
      minDate={today}
      maxDate={maxDate}
      isDateDisabled={(date) => date.getDay() === 0 || date.getDay() === 6} // Disable weekends
      placeholder="Select date (next 3 months, no weekends)"
    />
  );
};
```

## Keyboard Navigation

The component supports comprehensive keyboard navigation:

- **Enter** or **Space**: Open/close calendar
- **Escape**: Close calendar
- **Arrow Keys**: Navigate between days
- **Page Up/Down**: Navigate between months
- **Home/End**: Navigate to start/end of week
- **Enter** or **Space**: Select date (when calendar is open)

## Accessibility Features

### ARIA Support
- `role="grid"` for the calendar
- `role="gridcell"` for individual days
- `aria-selected` for selected dates
- `aria-disabled` for disabled dates
- `aria-label` for date descriptions
- `aria-expanded` for popover state

### Focus Management
- Focus trapping within the calendar when open
- Focus return to trigger button when closed
- Proper tab order and keyboard navigation
- Visual focus indicators

### Screen Reader Support
- Descriptive labels for all interactive elements
- Date announcements with context
- Clear indication of selected dates and ranges
- Proper heading structure

## Design System Integration

The component uses Tailwind CSS classes that reference the design system tokens:

### Colors
- Primary colors: `brand-orange`, `brand-navy`
- Neutral colors: `text-primary`, `text-secondary`, `bg-primary`, `bg-secondary`
- Border colors: `border-color`
- System colors: `system-success`, `system-error`, `system-warning`, `system-info`

### Spacing
- Consistent spacing using Tailwind spacing scale
- Padding and margins follow design system guidelines

### Typography
- Inter font family for body text
- Consistent font weights and sizes
- Proper line heights and letter spacing

### Dark Mode
- Full dark mode support with `dark:` prefixes
- Proper contrast ratios maintained
- Theme-aware color switching

## Styling

The component uses styled components with design system integration:

```typescript
// Example styled component
const StyledInput = React.forwardRef<HTMLButtonElement, {...}>(({ children, className = '', ...props }, ref) => (
  <button
    ref={ref}
    className={`
      w-full h-12 px-4 text-left
      bg-white dark:bg-dark-bg-secondary
      border border-border-color dark:border-dark-border-color
      rounded-lg
      text-text-primary dark:text-dark-text-primary
      focus:outline-none focus:ring-2 focus:ring-brand-orange dark:focus:ring-dark-brand-orange
      hover:border-brand-orange dark:hover:border-dark-brand-orange
      disabled:opacity-50 disabled:cursor-not-allowed
      transition-colors duration-200
      ${className}
    `}
    {...props}
  >
    {children}
  </button>
));
```

## Testing

The component includes comprehensive test coverage:

- **Unit Tests**: Component behavior and state management
- **Accessibility Tests**: Keyboard navigation and screen reader compatibility
- **Visual Tests**: Design system integration and responsive behavior
- **Integration Tests**: Popover behavior and date selection

## Browser Support

- Chrome 90+
- Firefox 88+
- Safari 14+
- Edge 90+

## Performance

- Optimized re-renders with React.memo and useCallback
- Efficient date calculations using date-fns
- Minimal bundle size impact
- Fast keyboard navigation

## Migration from Original DatePicker

The Enhanced DatePicker is a complete rewrite with improved API:

### Breaking Changes
- Different prop interface (simplified and more focused)
- Different onChange signature
- Removed many unused props from original component

### Migration Guide
1. Update import: `import { EnhancedDatePicker } from '@acutrack-bookprint/acutrack-ds'`
2. Update props to match new interface
3. Update onChange handlers to handle new signature
4. Test accessibility and keyboard navigation

## Files Created

- `src/components/EnhancedDatePicker.tsx` - Main component
- `src/test-pages/EnhancedDatePickerTest.tsx` - Test page
- `enhanced-datepicker-test.html` - HTML test file
- `ENHANCED_DATEPICKER_DOCUMENTATION.md` - This documentation

## Future Enhancements

Potential future improvements:
- Month/year picker views
- Preset date ranges (Last 7 days, This month, etc.)
- Time picker integration
- Multiple calendar views for range selection
- Custom day cell rendering
- Localization support

## Support

For issues or questions about the Enhanced DatePicker component:
1. Check this documentation
2. Review the test examples
3. Check the component source code
4. Contact the Acutrack Design System team
