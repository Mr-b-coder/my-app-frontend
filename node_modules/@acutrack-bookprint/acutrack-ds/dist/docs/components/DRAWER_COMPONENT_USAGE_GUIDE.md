# Drawer Component Usage Guide

## Overview

The Drawer component is a slide-out panel that appears from the left, right, top, or bottom of the viewport. It supports position-aware sizing, compound components, focus trapping, keyboard navigation, and a fixed or theme-based size scale. Use it for filters, forms, navigation, settings, or any secondary content that shouldn’t take the full screen like a modal.

### Features

- **Positions**: `left`, `right`, `top`, `bottom`
- **Sizes**: `xs`, `sm`, `md`, `lg`, `xl`, `full` with position-aware behavior (width for left/right, height for top/bottom)
- **Fixed scale**: Theme-independent sizing so `xs` through `xl` progress correctly; override with `className` or `useThemeSizing`
- **Compound components**: `Drawer.Header`, `Drawer.Body`, `Drawer.Footer`
- **Accessibility**: Focus trap (via `focus-trap-react`), Escape to close, ARIA attributes
- **Backdrop**: Optional; `closeOnBackdropClick` to close on overlay click
- **Animations**: Smooth slide-in/out animations via `framer-motion`
- **Scroll Locking**: Prevents body scroll without layout shifts using `react-remove-scroll`

## Table of Contents

1. [Installation](#installation)
2. [Basic Usage](#basic-usage)
3. [Component API](#component-api)
4. [Position Options](#position-options)
5. [Size Options](#size-options)
6. [useThemeSizing (Backward Compatibility)](#usethemesizing-backward-compatibility)
7. [Compound Components](#compound-components)
8. [Accessibility](#accessibility)
9. [Examples](#examples)
10. [Best Practices](#best-practices)
11. [Troubleshooting](#troubleshooting)

## Installation

```bash
npm install @acutrack-bookprint/acutrack-ds
```

```tsx
import { Drawer, Button } from '@acutrack-bookprint/acutrack-ds';
import '@acutrack-bookprint/acutrack-ds/style.css';
```

## Basic Usage

### Simple Drawer

```tsx
import React, { useState } from 'react';
import { Drawer, Button } from '@acutrack-bookprint/acutrack-ds';

function App() {
  const [isOpen, setIsOpen] = useState(false);

  return (
    <>
      <Button onClick={() => setIsOpen(true)}>Open Drawer</Button>

      <Drawer isOpen={isOpen} onClose={() => setIsOpen(false)}>
        <Drawer.Header>Panel Title</Drawer.Header>
        <Drawer.Body>
          <p>Drawer content. Use for filters, forms, or navigation.</p>
        </Drawer.Body>
        <Drawer.Footer>
          <Button variant="ghost" onClick={() => setIsOpen(false)}>Cancel</Button>
          <Button onClick={() => setIsOpen(false)}>Save</Button>
        </Drawer.Footer>
      </Drawer>
    </>
  );
}
```

## Component API

### Drawer (Root) Props

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `isOpen` | `boolean` | **required** | Controls drawer visibility |
| `onClose` | `() => void` | **required** | Called when the drawer should close (Escape, backdrop, close button) |
| `position` | `'left' \| 'right' \| 'top' \| 'bottom'` | `'right'` | Edge from which the drawer slides in |
| `size` | `'xs' \| 'sm' \| 'md' \| 'lg' \| 'xl' \| 'full'` | `'md'` | Size (width for left/right, height for top/bottom). Fixed scale by default. |
| `useThemeSizing` | `boolean` | `false` | Use theme `max-w-*` / `max-h-*` instead of the fixed scale |
| `hasBackdrop` | `boolean` | `true` | Show dimmed overlay behind the drawer |
| `closeOnBackdropClick` | `boolean` | `true` | Close when the backdrop is clicked |
| `className` | `string` | - | Extra classes; applied last so it can override size/position |
| `style` | `React.CSSProperties` | - | Inline styles; merged after size-related styles |
| `children` | `React.ReactNode` | **required** | Usually `Drawer.Header`, `Drawer.Body`, `Drawer.Footer` |

> **Note:** The panel’s base classes do **not** include hardcoded position or size. `position`, `size`, `className`, and `style` are applied as documented and are not overridden by the panel.

### Drawer.Header Props

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `children` | `React.ReactNode` | **required** | Header title |
| `hasCloseButton` | `boolean` | `true` | Show the close (X) button |
| `className` | `string` | - | Extra CSS classes |
| `style` | `React.CSSProperties` | - | Inline styles |

### Drawer.Body Props

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `children` | `React.ReactNode` | **required** | Main content; scrolls when it overflows |
| `className` | `string` | - | Extra CSS classes |
| `style` | `React.CSSProperties` | - | Inline styles |

### Drawer.Footer Props

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `children` | `React.ReactNode` | **required** | Footer content (e.g. actions) |
| `className` | `string` | - | Extra CSS classes |
| `style` | `React.CSSProperties` | - | Inline styles |

## Position Options

The drawer can slide in from four edges:

```tsx
// Right (default) – common for detail/edit panels
<Drawer isOpen={isOpen} onClose={onClose} position="right">
  ...
</Drawer>

// Left – often for navigation or filters
<Drawer isOpen={isOpen} onClose={onClose} position="left">
  ...
</Drawer>

// Top – banners, notifications
<Drawer isOpen={isOpen} onClose={onClose} position="top">
  ...
</Drawer>

// Bottom – bottom sheets, mobile-friendly
<Drawer isOpen={isOpen} onClose={onClose} position="bottom">
  ...
</Drawer>
```

### When to use each

| Position | Typical use |
|----------|-------------|
| `right` | Edit forms, detail panels, settings |
| `left` | Navigation, filters, side menu |
| `top` | Announcements, compact filters |
| `bottom` | Mobile actions, pickers, compact forms |

## Size Options

Sizing is **position-aware**:

- **Left/Right**: `size` sets **width** (max-width in rem).
- **Top/Bottom**: `size` sets **height** (max-height in rem or viewport).

A **fixed scale** is used by default so `xs` &lt; `sm` &lt; `md` &lt; `lg` &lt; `xl` regardless of your Tailwind theme. Sizes are applied via inline `maxWidth` / `maxHeight`.

### Left/Right sizes (width)

| Size | Width |
|------|-------|
| `xs` | 20rem (320px) |
| `sm` | 24rem (384px) |
| `md` | 28rem (448px) |
| `lg` | 32rem (512px) |
| `xl` | 36rem (576px) |
| `full` | 100% |

### Top/Bottom sizes (height)

| Size | Height |
|------|--------|
| `xs` | 12rem |
| `sm` | 16rem |
| `md` | 18rem |
| `lg` | 20rem |
| `xl` | 24rem |
| `full` | 100vh |

### Overriding with `className`

`className` is applied last, so you can override size or position:

```tsx
<Drawer size="md" className="!max-w-[400px]">
  ...
</Drawer>
```

## useThemeSizing (Backward Compatibility)

With `useThemeSizing={true}`, width (left/right) and height (top/bottom) use your theme’s `max-w-*` and `max-h-*` classes instead of the fixed rem scale.

```tsx
<Drawer isOpen={isOpen} onClose={onClose} useThemeSizing size="md">
  ...
</Drawer>
```

Use this if you previously relied on your Tailwind theme’s `maxWidth`/`maxHeight` for the Drawer.

## Compound Components

### Drawer.Header

Title and optional close button. The close button calls `onClose`.

```tsx
<Drawer.Header>Edit Profile</Drawer.Header>

// Without close button
<Drawer.Header hasCloseButton={false}>Read-only Panel</Drawer.Header>
```

### Drawer.Body

Scrollable area. Use for forms, lists, or long content.

```tsx
<Drawer.Body>
  <form>...</form>
</Drawer.Body>
```

### Drawer.Footer

For actions. Footer is not required.

```tsx
<Drawer.Footer>
  <Button variant="ghost" onClick={onClose}>Cancel</Button>
  <Button onClick={onSave}>Save</Button>
</Drawer.Footer>
```

## Accessibility

- **Focus trap**: Focus stays inside the drawer; Tab/Shift+Tab cycle through focusable elements.
- **Escape**: Closes the drawer.
- **ARIA**: `role="dialog"`, `aria-modal="true"`, `aria-labelledby="drawer-title"`, `aria-describedby` on the body.
- **Close button**: `aria-label="Close drawer"`.

## Examples

### Filters panel

```tsx
<Drawer isOpen={isOpen} onClose={onClose} position="right" size="sm">
  <Drawer.Header>Filters</Drawer.Header>
  <Drawer.Body>
    <Select label="Category" options={...} />
    <Select label="Date range" options={...} />
    <Checkbox label="Active only" ... />
  </Drawer.Body>
  <Drawer.Footer>
    <Button variant="ghost" onClick={onClose}>Reset</Button>
    <Button onClick={applyFilters}>Apply</Button>
  </Drawer.Footer>
</Drawer>
```

### Edit form (right, medium)

```tsx
<Drawer isOpen={isOpen} onClose={onClose} position="right" size="lg">
  <Drawer.Header>Edit Profile</Drawer.Header>
  <Drawer.Body>
    <Input label="Full Name" ... />
    <Input label="Email" type="email" ... />
    <Textarea label="Bio" rows={4} ... />
  </Drawer.Body>
  <Drawer.Footer>
    <Button variant="ghost" onClick={onClose}>Cancel</Button>
    <Button onClick={onSave}>Save</Button>
  </Drawer.Footer>
</Drawer>
```

### Navigation (left)

```tsx
<Drawer isOpen={isOpen} onClose={onClose} position="left" size="sm">
  <Drawer.Header>Menu</Drawer.Header>
  <Drawer.Body>
    <nav>
      <a href="/">Dashboard</a>
      <a href="/projects">Projects</a>
      <a href="/settings">Settings</a>
    </nav>
  </Drawer.Body>
</Drawer>
```

### Bottom sheet (mobile-style)

```tsx
<Drawer isOpen={isOpen} onClose={onClose} position="bottom" size="md">
  <Drawer.Header>Options</Drawer.Header>
  <Drawer.Body>
    <ul>...</ul>
  </Drawer.Body>
</Drawer>
```

## Best Practices

1. **Always pass `onClose`**  
   The drawer needs a way to close (Escape, backdrop, close button).

2. **Pick position and size by use case**  
   - Right + `md`/`lg` for forms.  
   - Left + `sm` for nav or filters.  
   - Bottom + `md` for mobile-friendly sheets.

3. **Override with `className` when needed**  
   Use `className="!max-w-[500px]"` (or similar) instead of changing the design system if you need one-off sizes.

4. **Use `useThemeSizing` only if you need it**  
   Prefer the default fixed scale for consistent behavior across apps and themes.

## Troubleshooting

### Drawer fills the whole screen for all sizes

Earlier versions used Tailwind arbitrary classes that might not be in the built CSS. The current Drawer uses inline `maxWidth`/`maxHeight` for the default fixed scale, so sizes should apply even when those utilities are not built. If you use `useThemeSizing`, ensure your theme defines the `max-w-*` / `max-h-*` classes you use.

### Sizes not ordered (e.g. `sm` wider than `md`)

This can happen with `useThemeSizing={true}` if your theme overrides `max-w-sm`, `max-w-md`, etc. Use the default fixed scale, or normalize your theme, or override with `className`.

### Drawer doesn’t close on backdrop click

Check `hasBackdrop={true}` and `closeOnBackdropClick={true}`. If you use a custom `onClose` that doesn’t update `isOpen`, the drawer will not close.

### Focus or Escape not working

Ensure `onClose` is a function and that it updates the `isOpen` state (or equivalent) so the drawer actually unmounts or hides.

## Support

For interactive examples, use the [Drawer Test Page](http://localhost:5175/drawer-test.html) or the [Component Test Hub](http://localhost:5175/component-test-hub.html).
