# üîç SearchBar Component

A fully accessible search bar for the Acutrack Design System, built on **Headless UI Combobox**. It supports suggestions, keyboard navigation, and light/dark theme.

---

## üìå Recent changes (refactor & DS alignment)

- **Headless UI Combobox**: Rebuilt for proper ARIA combobox/listbox behavior and keyboard navigation (arrows, Enter, Escape, Tab).
- **Variants**: Aligned with Input ‚Äî `primary` | `secondary` | `outline` | `ghost` | `filled`.
- **Sizing**: Matches Input ‚Äî `xs` (h-8), `sm` (h-10), `md` (h-12), `lg` (h-14), `xl` (h-16) with corresponding text sizes.
- **Color**: New `color` prop (`primary` | `success` | `warning` | `danger` | `info`) for border and focus ring, aligned with Input.
- **Label & label mode**: Optional `label`, `showLabel`, `labelMode` (`top` | `floating`), `labelClassName`, `id` ‚Äî same behavior as Input (top label above field or floating label inside).
- **Other new props**: `radius`, `isDisabled`, `ariaLabel`, `showSearchIcon`, `leftIcon`, `rightIcon`; focus ring and dropdown use DS tokens.
- **Removed**: Legacy props such as `behavior`, `minimal`, `hasShadow`, `hasBorder`, `hasVoiceSearch`, `hasFilters`; use `variant`/`className` and compose features in your app.

---

## üìñ Migration Guide (Headless UI Refactor)

### Why This Change Was Necessary

The previous SearchBar used complex, manual state and event handlers for behavior and suggestions. Implementing keyboard navigation and accessibility correctly that way is difficult and error-prone.

The new SearchBar is built on **Headless UI‚Äôs Combobox**, which provides:

- **Accessibility**: Standard keyboard behavior (Arrow keys, Home, End, Enter, Escape, Tab) and ARIA attributes for screen readers.
- **Simpler code**: Less custom state and event logic, so the component is easier to maintain.
- **Robust behavior**: Focus and state are handled by the library, reducing bugs.

### Backward Compatibility

This is an internal refactor. The main way you use SearchBar is unchanged.

**Props that stay the same:** `value`, `onChange`, `onSearch`, `suggestions`, `onSuggestionSelect`, `isLoading`, `placeholder`, `size`, `variant`, `className`. New props added: `radius`, `color`, `showSearchIcon`, `leftIcon`, `rightIcon`, `isDisabled`, `ariaLabel`, `label`, `showLabel`, `labelMode`, `labelClassName`, `id`.

**Props that were removed:** Many optional styling/feature flags (e.g. `hasShadow`, `hasBorder`, `hasVoiceSearch`, `hasFilters`, `behavior`, `minimal` variant) were removed. Use `variant` and `className` for styling. For things like voice search or filters, compose them around SearchBar in your app.

### Example Usage (No Change for Core API)

```tsx
const [searchValue, setSearchValue] = useState('');
const [suggestions, setSuggestions] = useState([]);

<SearchBar
  value={searchValue}
  onChange={setSearchValue}
  onSearch={(query) => console.log('Searching for:', query)}
  suggestions={suggestions}
  onSuggestionSelect={(s) => setSearchValue(s.text)}
  isLoading={false}
/>
```

---

## ‚ú® Features

- **Variants**: primary, secondary, outline, ghost, filled (aligned with Input)
- **Sizes**: xs, sm, md, lg, xl ‚Äî heights and text sizes match Input (h-8 / text-xs through h-16 / text-xl)
- **Color**: Border and focus ring theme ‚Äî primary, success, warning, danger, info (aligned with Input)
- **Label & label mode**: Optional label with `top` (above field) or `floating` (inside, floats on focus/fill), aligned with Input
- **Icons**: Optional search icon (on/off), custom left/right icons (e.g. filter, tune)
- **Suggestions**: Dropdown with trim-based filtering and full keyboard navigation (Headless UI)
- **Accessibility**: ARIA, `ariaLabel`, and keyboard support via Combobox
- **States**: Loading, disabled (DS-aligned styling), clear button
- **Theme**: Light/dark mode
- **TypeScript**: Full type safety

## üöÄ Quick Start

```tsx
import { SearchBar } from '@acutrack-bookprint/acutrack-ds';

const [value, setValue] = useState('');

<SearchBar
  value={value}
  onChange={setValue}
  onSearch={(query) => console.log(query)}
  placeholder="Search..."
  size="md"
/>
```

## üì± Expandable Search

Use **ExpandableSearchButton** for ‚Äúclick icon to expand‚Äù behavior; it composes the SearchBar and manages expand/collapse state.

## üé® Variants (aligned with Input)

Variants match the Input component (background and border style). The **border color** (default and focus) and focus ring come from the `color` prop (see **Color** below). Default variant is **primary**.

### Primary (default)
```tsx
<SearchBar value={value} onChange={setValue} />
<SearchBar value={value} onChange={setValue} variant="primary" />
```
Background: `bg-bg-secondary`. Border uses `color` (default `primary` = brand-navy / dark-brand-orange).

### Secondary
```tsx
<SearchBar value={value} onChange={setValue} variant="secondary" />
```
Background: `bg-bg-tertiary` / `dark:bg-dark-bg-primary`. Border color from `color` prop.

### Outline
```tsx
<SearchBar value={value} onChange={setValue} variant="outline" />
```
Transparent background, `border-2`. Border color from `color` prop.

### Ghost
```tsx
<SearchBar value={value} onChange={setValue} variant="ghost" />
```
Transparent by default; border and background on hover/focus.

### Filled
```tsx
<SearchBar value={value} onChange={setValue} variant="filled" />
```
Background: `bg-bg-primary`, no border.

## üìè Sizes (aligned with Input)

Sizing matches the Input component: same heights and text sizes.

| Size | Height | Text |
|------|--------|------|
| `xs` | h-8 | text-xs |
| `sm` | h-10 | text-sm |
| `md` | h-12 | text-base (default) |
| `lg` | h-14 | text-lg |
| `xl` | h-16 | text-xl |

```tsx
<SearchBar size="xs" />   {/* Extra Small */}
<SearchBar size="sm" />   {/* Small */}
<SearchBar size="md" />   {/* Medium (Default) */}
<SearchBar size="lg" />   {/* Large */}
<SearchBar size="xl" />   {/* Extra Large */}
```

## üé® Color (aligned with Input)

The `color` prop sets the **border color** (default and focus) and the **focus ring**, so changing `color` is visible even when the field is not focused.

| Color | Border (default + focus) | Focus ring |
|-------|---------------------------|------------|
| `primary` (default) | brand-navy (light) / dark-brand-orange (dark) | same |
| `success` | green-500 / green-600 on focus | green-500 |
| `warning` | yellow-500 / yellow-600 on focus | yellow-500 |
| `danger` | red-500 / red-600 on focus | red-500 |
| `info` | blue-500 / blue-600 on focus | blue-500 |

*Ghost variant* keeps a transparent border until focus; then the focus border and ring use the chosen color.

```tsx
<SearchBar value={value} onChange={setValue} color="primary" />
<SearchBar value={value} onChange={setValue} color="success" />
<SearchBar value={value} onChange={setValue} color="warning" />
<SearchBar value={value} onChange={setValue} color="danger" />
<SearchBar value={value} onChange={setValue} color="info" />
```

## üè∑Ô∏è Label and label mode (aligned with Input)

Optional label with the same behavior as Input: **top** (label above the field) or **floating** (label inside the field, floats up when focused or filled).

- **label**: Label text (e.g. `"Search"`).
- **showLabel**: Whether to show the label (default `true` when `label` is set).
- **labelMode**: `'top'` (default) or `'floating'`.
- **labelClassName**: Extra classes for the label.
- **id**: Id for the input (used by `htmlFor` when `labelMode === 'top'`).

### Top label (default)
```tsx
<SearchBar
  label="Search"
  labelMode="top"
  value={value}
  onChange={setValue}
  id="search-input"
/>
```

### Floating label
```tsx
<SearchBar
  label="Search"
  labelMode="floating"
  value={value}
  onChange={setValue}
  id="search-input"
/>
```
With `floating`, the label sits inside the field and moves up when the field is focused or has a value; placeholder is hidden.

## üîó ButtonGroup Integration

Use SearchBar with ButtonGroup for toolbars and headers:

```tsx
import { SearchBar, ButtonGroup, Button } from '@acutrack-bookprint/acutrack-ds';

const [query, setQuery] = useState('');

<div className="flex items-center gap-4">
  <SearchBar
    value={query}
    onChange={setQuery}
    onSearch={handleSearch}
    placeholder="Search..."
    variant="outline"
    size="md"
    isClearable
    className="flex-1"
  />
  <ButtonGroup>
    <Button variant="primary" size="md">Search</Button>
    <Button variant="outline" size="md">Advanced</Button>
    <Button variant="ghost" size="md">Filters</Button>
  </ButtonGroup>
</div>
```

### ExpandableSearchButton in ButtonGroup

For seamless integration, use the `ExpandableSearchButton` component:

```tsx
import { ExpandableSearchButton, ButtonGroup, Button } from '@acutrack-bookprint/acutrack-ds';

<ButtonGroup>
  <Button variant="primary" size="md">Home</Button>
  <Button variant="outline" size="md">About</Button>
  <ExpandableSearchButton
    placeholder="Search..."
    onSearch={handleSearch}
    variant="outline"
    size="md"
    hasSuggestions={true}
  />
  <Button variant="ghost" size="md">Contact</Button>
</ButtonGroup>
```

**Perfect for navigation bars, toolbars, and compact interfaces!**

## üöÄ Suggestions

Pass a list of suggestions; the component **filters by the trimmed input** (so e.g. `"spring "` still matches ‚ÄúSpringfield‚Äù) and supports keyboard selection (Headless UI):

```tsx
const [value, setValue] = useState('');
const [suggestions, setSuggestions] = useState<SearchSuggestion[]>([]);

<SearchBar
  value={value}
  onChange={setValue}
  onSearch={handleSearch}
  suggestions={suggestions}
  onSuggestionSelect={(s) => setValue(s.text)}
  noSuggestionsText="No results found."
/>
```

Filter or fetch suggestions in your app (e.g. in `onChange` or with debounce) and pass the result into `suggestions`. For address-style flows, you can also offer a ‚ÄúUse current input‚Äù option when the typed value is not in the list (see test page). To **show all suggestions without filtering** (e.g. parent controls the list or API returns pre-filtered data), set `filterSuggestions={false}` so the dropdown displays the full list as passed in.

## üîß Icons

- **Show/hide search icon:** `showSearchIcon={false}` removes the default left search icon.
- **Custom left icon:** Pass `leftIcon={<Icon>filter_list</Icon>` (or any `ReactNode`) to replace or add left content.
- **Custom right icon:** Pass `rightIcon={<Icon>tune</Icon>`; it appears before the loading spinner and clear button.

```tsx
<SearchBar
  value={value}
  onChange={setValue}
  showSearchIcon={true}
  leftIcon={<Icon className="w-5 h-5">filter_list</Icon>}
  rightIcon={<Icon className="w-4 h-4">tune</Icon>}
/>
```

## üìê Radius, color & states

- **radius**: `'none' | 'sm' | 'md' | 'lg' | 'xl' | 'full'` ‚Äî matches Input/Select. Default `'md'` (`rounded`).
- **color**: `'primary' | 'success' | 'warning' | 'danger' | 'info'` ‚Äî border and focus ring theme (matches Input). Default `'primary'`.
- **isDisabled**: When `true`, input is non-editable and uses DS disabled styling (gray background, muted border, cursor-not-allowed).
- **ariaLabel**: Accessible name for the combobox (e.g. `"Search addresses"`). Falls back to label or placeholder when not set.

## üìÑ Hiding the dropdown & triggering when required

Use **showSuggestionsList** to control when the list appears. When `false`, the dropdown is never shown. Pass a boolean from your app (e.g. only after 2+ chars, or after an API returns).

```tsx
// Dropdown only after 2+ characters (address-style)
<SearchBar
  value={address}
  onChange={setAddress}
  suggestions={addressSuggestions}
  showSuggestionsList={address.trim().length >= 2}
/>

// Hide list until your condition is met (e.g. after first search)
<SearchBar
  value={query}
  onChange={setQuery}
  suggestions={results}
  showSuggestionsList={hasSearchedOnce}
/>
```

## üìÑ Address-style & selected chip (app-side)

For address or autocomplete fields: type a few characters, show suggestions (e.g. from an API), and let the user **select one or type the full value**. Use `showSuggestionsList={value.trim().length >= 2}` so the list appears only after 2+ characters. The test page demonstrates this with optional **selected chip** UI: after selection, show a chip with the value and ‚ÄúChange‚Äù / clear; toggle this behavior on or off in your app.

## üìã API Reference

### Props

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `value` | `string` | **required** | Controlled input value |
| `onChange` | `(query: string) => void` | **required** | Called when the input value changes |
| `placeholder` | `string` | `"Search..."` | Placeholder text |
| `onSearch` | `(query: string) => void` | ‚Äî | Called on form submit (Enter) |
| `suggestions` | `SearchSuggestion[]` | `[]` | Options shown in the dropdown (filtered by trimmed input) |
| `onSuggestionSelect` | `(suggestion: SearchSuggestion) => void` | ‚Äî | Called when user selects a suggestion |
| `isLoading` | `boolean` | `false` | Shows loading spinner |
| `size` | `SearchBarSize` | `"md"` | xs, sm, md, lg, xl (heights match Input: h-8‚Äìh-16) |
| `variant` | `SearchBarVariant` | `"primary"` | primary, secondary, outline, ghost, filled (matches Input) |
| `color` | `SearchBarColor` | `"primary"` | primary, success, warning, danger, info (border/focus ring; matches Input) |
| `radius` | `'none' \| 'sm' \| 'md' \| 'lg' \| 'xl' \| 'full'` | `"md"` | Border radius (DS form control alignment) |
| `className` | `string` | ‚Äî | Extra class for the wrapper |
| `showSearchIcon` | `boolean` | `true` | Show default left search icon (ignored if `leftIcon` is set) |
| `leftIcon` | `React.ReactNode` | ‚Äî | Custom left content (replaces default search icon when set) |
| `rightIcon` | `React.ReactNode` | ‚Äî | Custom right content (before loading/clear) |
| `isClearable` | `boolean` | `true` | Show clear button when there is text |
| `noSuggestionsText` | `string` | `"No results found."` | Shown when there are no suggestions |
| `isDisabled` | `boolean` | `false` | Disables input and applies DS disabled styling |
| `ariaLabel` | `string` | ‚Äî | Accessible name for the combobox |
| `label` | `string` | ‚Äî | Label text (e.g. "Search"); renders above or floating per labelMode |
| `showLabel` | `boolean` | `true` | Whether to show the label (when label is set) |
| `labelMode` | `SearchBarLabelMode` | `"top"` | 'top' (above field) or 'floating' (inside, floats on focus/fill) |
| `labelClassName` | `string` | ‚Äî | Extra classes for the label |
| `id` | `string` | ‚Äî | Id for the input; used by label htmlFor when labelMode is 'top' |
| `showSuggestionsList` | `boolean` | `true` | When false, the dropdown is never shown; set from your logic (e.g. `value.trim().length >= 2` for address-style) |
| `filterSuggestions` | `boolean` | `true` | When false, all suggestions are shown without filtering by input; use when the parent controls the list (e.g. API returns pre-filtered data) |

### Types

```tsx
export type SearchBarVariant = 'primary' | 'secondary' | 'outline' | 'ghost' | 'filled';
export type SearchBarSize = 'xs' | 'sm' | 'md' | 'lg' | 'xl';
export type SearchBarColor = 'primary' | 'success' | 'warning' | 'danger' | 'info';
export type SearchBarLabelMode = 'top' | 'floating';

export interface SearchSuggestion {
  id: string;
  text: string;
  description?: string;
  icon?: string;
}
```

## üß™ Testing

### Test Page
Open `search-test.html` (or the SearchBar card in the Component Test Hub).

### Test Features
1. **Basic**: Type, clear, submit (Enter)
2. **Suggestions**: Dropdown and keyboard (arrows, Enter, Escape); filtering uses trimmed value (e.g. `"spring "` still shows Springfield)
3. **Variants, sizes & color**: primary, secondary, outline, ghost, filled; xs‚Äìxl (Input-aligned heights); color primary/success/warning/danger/info
4. **Label & label mode**: Top label and floating label (aligns with Input)
5. **Icons**: Show search icon, custom left icon, custom right icon
6. **Radius, disabled, ariaLabel**: In the play area and code tab
7. **Address-style autocomplete**: Dropdown hidden until 2+ chars (`showSuggestionsList`); ‚ÄúShow suggestions list‚Äù toggle to hide/show list; optional ‚ÄúShow selected chip‚Äù toggle
8. **ExpandableSearchButton**: Use for expand-on-click in headers

## üéØ Design System Compliance

- ‚úÖ **Follows Acutrack patterns**: Variants, sizes, states
- ‚úÖ **Uses brand colors**: Brand orange, navy, system colors
- ‚úÖ **Typography**: Inter (body), Raleway (headings)
- ‚úÖ **Spacing**: Consistent size system
- ‚úÖ **Theme support**: Full dark/light mode
- ‚úÖ **Accessibility**: ARIA labels, keyboard navigation
- ‚úÖ **Responsive**: Mobile-first design

## üîß Customization

- Use `className` to adjust layout or width; use `variant`, `color`, and `radius` for the main look (default variant `primary`, color `primary`, radius `md`). Sizing matches Input (xs‚Äìxl).
- Use `label` and `labelMode` (`top` or `floating`) for labeled fields, aligned with Input.
- Use `showSearchIcon`, `leftIcon`, and `rightIcon` for icon control without wrapping the component; when `leftIcon` is set, it replaces the default search icon.
- For filters, voice search, or selected-chip UI, compose additional UI around the SearchBar in your app (see **Search Test Page** in the Component Test Hub for the address autocomplete + optional selected chip pattern).

## üì± Browser Support

- ‚úÖ **Modern browsers**: Chrome, Firefox, Safari, Edge
- ‚úÖ **Mobile**: iOS Safari, Chrome Mobile
- ‚úÖ **Accessibility**: Screen readers, keyboard navigation
- ‚úÖ **Touch**: Mobile-friendly interactions

## üîÑ Migration from Header SearchBar

If you were using the old Header SearchBar:

```tsx
// Old (Header component)
<Header hasSearch={true} onSearch={handleSearch} />

// New (Standalone SearchBar)
<SearchBar onSearch={handleSearch} />
```

## ü§ù Contributing

This component follows the Acutrack Design System architecture:
- **Polymorphic components** with `as` prop support
- **Consistent prop interfaces** with detailed TypeScript types
- **Composition-based design** for flexibility
- **Industry-standard patterns** for maintainability

## üìÑ License

Part of the Acutrack Design System - UNLICENSED
